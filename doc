										桥梁大数据项目技术文档
-------------------------------------------目录------------------------------------
-------------------------------------------1 部署架构------------------------------
-----------------------------------------------1.1系统部署-------------------------
-----------------------------------------------1.2中间件部署-----------------------
-------------------------------------------2 系统设计------------------------------
-------------------------------------------3 系统扩展------------------------------
-----------------------------------------------------------------------------------
1 部署架构
   ---------------------------------------------------------------------------------
 	1.1 系统部署
	 war包类型的项目可以独立部署于tomcat上,jar包类型的项目做公用层
	 ----工程名称----------------------------------------------工程描述----------打包类型
	-----------------------------------------------------------------------------------
	---bridge------------------------------------------父项目------------pom
	------bridge-common-------------------------------工具类------------jar
	------bridge-common-dao------------------------------------------关系型数据库访问层支持模块---------jar
	------bridge-hbase----------------------------------------hbase访问层------jar
	------bridge-kafka----------------------------------------kafka访问层------jar
	------bridge-pool----------------------------------------池技术层------jar
	------bridge-web----------------------------------------对外接入层------war
	------bridge-middle----------------------------------------中间层(连接kafka和hbase做数据入库)------war
	------bridge-admin----------------------------------------后台管理系统------war
	------bridge-platform----------------------------------------平台管理系统(第三方接入层)------war
    ---------------------------------------------------------------------------------
 	1.2 中间件部署
	hadoop集群
	Master(39.105.3.250)	Slave1(120.79.166.67)	Slave2(47.104.66.18)
	NameNode				ResourceManage	 			SecondaryNameNode
	DataNode				DataNode					DataNode
	NodeManager				NodeManager					NodeManager
	 													
	zookeeper集群
   	Master(39.105.3.250)	Slave1(120.79.166.67)	Slave2(47.104.66.18) 
   	三台机器都部署了,1个leader,2个slave(leader由zookeeper集群选举)
   	
	habase 集群
	HMaster(39.105.3.250)	HRegionServer(120.79.166.67) HRegionServer(47.104.66.18)
	
	kafka集群
	39.105.3.250,120.79.166.67,47.104.66.18
	partition的leader 由kafka 自行维护
----------------------------------------------------------------------------------
2 系统设计
 bridge-web
  	 数据接入层
  		com.ande.bridge.web.controller.DataAccessController 这个类是数据接入接口
  	数据检验层
  		com.ande.bridge.web.check.Check 这个类是数据校验接口,通过传入的code码查出bridgeId和equipmentId,并返回Data对象
  	 	数据模型
	  	包:com.ande.bridge.web.model
	  	类:Data 这个是数据模型的基类,定义传感器接入系统所需的必须基本参数
	  	类:DataAcceleration 这是加速度传感器的数据模型,继承Data基类
  		传感器数据模型枚举类
  		包:com.ande.bridge.web.model
  		类:Sensor 数据模型枚举 ,扩展新的传感器数据模型时需要在这个类里新增类型
bridge-kafka
 	数据缓冲层,考虑上下游系统接入速率的问题,故此引入这个buffer
bridge-middle
	数据存储层
 	从kafka消费数据,然后数据入hbase
------------------------------------------------------------------------------------
3 系统扩展
 3.1 新增传感器类型(数据结构不一致)
     1 新增类 数据模型,继承Data基类(类似DataAcceleration类)
     2 Sensor 新增类型,并指定kafka 的topic
     3 bridge-middle 新增kafka消费者(参考com.ande.bridge.middle.KafkaConsumer)
  3.2 新增其他平台业务
     1 在bridge-platfrom项目新增接口,所有接口的访问需要在拦截器内检验客户端传过来的token
     com.ande.bridge.platform.controller.TokenGenerateController 这个类封装了token的获取,以及过期重新获取的分布式锁
